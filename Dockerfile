FROM node:18
WORKDIR /home/node/app
# Build metu perduodami argumentai
ARG REACT_APP_SHARETRIBE_SDK_CLIENT_ID
ARG REACT_APP_MARKETPLACE_ROOT_URL
ARG REACT_APP_ENV
ARG REACT_APP_CSP=block

# Įrašome aplinkos kintamuosius į ENV
ENV REACT_APP_SHARETRIBE_SDK_CLIENT_ID=${REACT_APP_SHARETRIBE_SDK_CLIENT_ID}
ENV REACT_APP_MARKETPLACE_ROOT_URL=${REACT_APP_MARKETPLACE_ROOT_URL}
ENV REACT_APP_ENV=${REACT_APP_ENV}
ENV REACT_APP_CSP=${REACT_APP_CSP}

COPY package.json ./
COPY yarn.lock ./
RUN yarn install
COPY . .
ENV PORT=4000
ENV NODE_ENV=production
EXPOSE 4000
RUN yarn run build
USER node
CMD ["yarn", "start"]

